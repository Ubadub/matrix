7/6/09
------

Customized grammars from Safiyyah's choices files.
hau, kal, and mal don't validate (but no red stars).

First attempt at loading grammars.

----
ute: 
----

Invalid type ACCUSATIVE
Unifications specified are invalid or do not unify
Type ACCUSATIVE-LEX-RULE has an invalid constraint specification
Invalid type NOMINATIVE
Unifications specified are invalid or do not unify
Type NOMINATIVE-LEX-RULE has an invalid constraint specification
Error: Problems in type file

Repairs:

Changed all instances of "nominative" to "nom" in choices
file, and all instances of "accusative" to "acc".  Then used
off-line customization system to create grammar.

Next problem:

Error in MOM-SUFFIX-MARKER-LEX-RULE:
  Unification with constraint of TAM failed at path (SYNSEM
                                                     LOCAL
                                                     CONT
                                                     HOOK
                                                     INDEX
                                                     E)

Repairs:

Changed this:

    verb-slot6_morph1_orth=-ku
      verb-slot6_morph1_feat1_name=aspect
      verb-slot6_morph1_feat1_value=mom-plus
      verb-slot6_morph1_feat1_head=verb

to this:

    verb-slot6_morph1_orth=-ku
      verb-slot6_morph1_feat1_name=situation
      verb-slot6_morph1_feat1_value=mom-plus
      verb-slot6_morph1_feat1_head=verb

Next problem:

Undefined wild card `?I' in NON-SINGULAR-SUFFIX
Undefined wild card `?M' in NON-SINGULAR-SUFFIX
Undefined wild card `?I' in NON-SINGULAR-SUFFIX
Nothing following character set character '?' in NON-SINGULAR-SUFFIX
Error: no valid morphological patterns in NON-SINGULAR-SUFFIX: rule-ignored
Undefined wild card `?A' in PLURAL-SUFFIX
Undefined wild card `?M' in PLURAL-SUFFIX
Undefined wild card `?I' in PLURAL-SUFFIX
Nothing following character set character '?' in PLURAL-SUFFIX
Error: no valid morphological patterns in PLURAL-SUFFIX: rule-ignored
Undefined wild card `?A' in PERFECTIVE-MARKER-SUFFIX
Undefined wild card `?K' in PERFECTIVE-MARKER-SUFFIX
Undefined wild card `?U' in PERFECTIVE-MARKER-SUFFIX
Nothing following character set character '?' in PERFECTIVE-MARKER-SUFFIX
Error: no valid morphological patterns in PERFECTIVE-MARKER-SUFFIX: rule-ignored
Undefined wild card `?I' in NEG-SUFFIX-SUFFIX
Nothing following character set character '?' in NEG-SUFFIX-SUFFIX
Error: no valid morphological patterns in NEG-SUFFIX-SUFFIX: rule-ignored

Repairs:

Replaced ? with 7 in choices and test suite file.  Grammar
loads!

Results:

Coverage: 10/27 positive examples, 37%
Overgeneration: 3/30 negative examples, 10%
Error: Unanalyzed lexical items in 26 examples

----
jig:
----

Redundancy involving NON-FEMININE
NON-FEMININE: NEUTER is redundant - it is an ancestor of VEGETABLE 

Repairs:

Changed definition of gender hierarchy to relatively
flat, with fem and non-fem, the latter having subtypes
masc, neut, and veg.

Moved animacy out of gender and made it an "other feature"
with possible values "anim/inam".  

Changed number to sg/non-sg, with du and pl under non-sg.
Some elements specify non-sg, others du, nothing outside
of pronouns direclty says sg, nothing directly says pl.

Initial coverage:  
Coverage: 11/56 36.7%
Overgeneration: 0
Error: 39/56

Problem:

case slot can't take number slot as its input.  Tried fixing this by
adding possible input for noun-slot2 and ran into ?bug with
-lex-rule-dtr being inherited by noun-lex and the subtypes of
noun-lex.

Tried removing this:
  noun-slot1_opt=on

Still having the same error, so trying putting this one back
in and then having noun-slot2 only take noun-slot1 as input.

  noun-slot1_opt=on


also: not getting any parses of verbs without object markers
because subject marker slot isn't available as input for
tense marker.  (Or maybe because object marker isn't optional?)
Try making the tense marker take the subject marker as an
additional possible input, and run into same -lex-rule-dtr
bug.

Not sure why this is working now, but here's the current
state of affairs:

    verb-slot3_input1_type=verb-slot2
    verb-slot3_input2_type=verb-slot1

It doesn't make sense to make the object marker optional,
because it only applies to tverbs as input.

Current competence:
Coverage: 14/30 46.7%
Overgeneration: 3/26 11.5%
Error: 14/56

Next issue:

Missing lexical entry for ngiji/see.  Added like this:

    verb1_stem2_orth=ngiji
    verb1_stem2_pred=_see_v_rel


But that's still not enough. Tried making obj marker (which
apparently comes after the subject marker in these examples)
take subject marker rules as input, but that runs into problems
with the tense lex rules which don't want obj marker input.
... because of this:

    verb-slot3_input1_type=verb-slot2
    verb-slot3_input1_type=verb-slot1

changed to:

    verb-slot3_input1_type=verb-slot2
    verb-slot3_input2_type=verb-slot1

That fixed three errors, all on ungrammatical examples.  In fact,
all remaining errors are on ungrammatical examples, and the changes
noted above also increased ambiguity.  So maybe they are actually
regressions. *** Check this ***

Next issue:

-rni (and probably other case markers) weren't taking
pronouns as input.  Tried fixing like this:

    noun-slot2_input2_type=noun4
    noun-slot2_input3_type=noun5
    noun-slot2_input4_type=noun6
    noun-slot2_input5_type=noun7
    noun-slot2_input6_type=noun8
    noun-slot2_input7_type=noun9
    noun-slot2_input8_type=noun10
    noun-slot2_input9_type=noun11

Competence:

Coverage: 25/30 83.3%
Overgeneration: 6/26 23.1%
Error: 10/56


Next issue:

Overgeneration of 1/2 subject agreement markers with
3rd person subjects.  The problem here is that the
common nouns weren't specified as third person in the
choices file.  Fixed like this (for each of noun1-3):

    noun1_feat2_name=pernum
    noun1_feat2_value=3rd

Resulting comptence figures:

Coverage: 25/30 = 83.3%
Overgeneration: 4/26 = 15.4%
Error: 10/56

Next issue:

There is spurious ambiguity in the current jig grammar because the
tense lexical rules can take the verb as a daughter directly.  This
looks like a customization bug (from the choices file, I don't think
this should happen).  In addition, however, the object markers are
effectively optional, and I don't think this is intended. The problem
is that the order, when both are present/overt is
subject-object-tense.  Since intransitives don't need object markers,
the tense rules have to be able to attach directly to subject markers
in the case of intransitive verbs.  BUT: With transitive verbs, the
object markers are presumably required.  (At least, I'm guessing so.
The ambiguity is arising because the third person objects are marked
with zeros...)

One solution is to make two sets of subject markers, one for
transitives and one for intransitives.  Then the tense marker rules
could attach to object markers or intranstive subject markers.  What I
do in the Wambaya grammar (not possible through the customization
system) is to put an zero-marked "intransitive" marker in the object
marker slot, requiring an empty COMPS list.

A complication, though, is some ungrammatical examples illustrating
incompatibility of 1st and 2nd person subject markers with certain
object markers.  I can't tell from the notes if this is because those
combinations of subjects and objects are just ineffable, or if "I see
you" would be expressed some other way.  If they are just ineffable,
it would be simple enough to say that the object markers also put some
constraints on the subjects of the verbs they attach to.  Another
solution is to make separate slots for the 1sg and 2nd subject markers
and have the object markers disallow them as input.

7/14/09: use "requires" and/or "other features" to let the object
marking rules select for the transitive verbs.  *** Interesting
interaction *** not yet considered in the customization system:
lexical rules that care about valence.  cf Wambaya TAM is sensitive to
png on subject & presence/absence of object.

----
nyn:
----

Cycle involving TRANSITIVE-VERB-LEX

Repairs:

Changed the following:


  verb1_name=transitive -> verb1_name=trans
  verb2_name=intransitive -> verb2_name=intrans

Next problem:

Error: pattern with no affixation ignored in NON-PRESENT-TENSE-PREFIX
Error: no valid morphological patterns in NON-PRESENT-TENSE-PREFIX: rule-ignored

The issue is that there is a slot with no morphemes defined
for it:

  verb-slot2_name=non-present-tense
  verb-slot2_order=before
    verb-slot2_input1_type=verb-slot6
  verb-slot3_name=remote-marker

Safiyyah explained that this was intended to house an empty
morpheme, so I added one.  Also added (per Safiyyah's instructions)
verb-slot3 and verb-slot4 as possible inputs to verb-slot6.

Now the grammar loads without errors!

Results:

Coverage: 0%
Overgeneration: 0%
Errors: 76/81

Repairs:

Added noun type for class 9 and stem for stick.
Fixed _n_rel on _sun_n_rel


SS-think that the grammar is not working because the tense lexical rules are 
incorrect.  As discussed in the meeting, I changed the tense lexical rules so that 
each had an extra rule without a morpheme that marked all the other tenses.

Coverage : 0%
Overgeneration: 0%
Errors: 65/81

Added missing lexical items:
kazi class 1 woman_n_rel
shaija class 1 _man_n_rel
renga intransitive _set_v_rel

Did interactive unification on the first test item and found that the class was that
the subject was marked as plural and the verb agreement marker was singular. 
This was incorrect in the choices file.  Changed

     noun-slot1_morph1_feat2_value=plural
to
     noun-slot1_morph1_feat2_value=singular

Ran grammar again (after deleting the subject-marker-lex-rule from main-verb-lex again)

Coverage: 28.6%
Overgeneration: 3.8%
Errors: 40/81



Found another lexical item that was missing
zaana intransitive _play_v_rel

Well-formed and 0 parses: 12

11 of these grammatical items that are not parsing are not expected to
parse given the current system.

Examples 2 and 3 demonstrate OSV and SOV word orders which are
possible in addition to the standard SVO.

Examples 12, 13, 14, 15, 16 demonstrate subject dropping.  The
reference grammar stated that overt pronouns are always emphatic.
Pro-drop is normal, so I did not include pronouns in the test suite.
(Maybe this should be done for the next go round)

Examples 37 and 40 have non-standard SOV word order to demonstrate the
object marker Object markers do not occur if the direct object follows
the verb.

Example 49 was mistakenly labeled as grammatical it was meant to be an
ungrammatical example demonstrating that the both the main verb and
auxliary require subject markers . I changed this in the test-suite
and made a new item file and placed it in tsdb/skeletons/nyn.

Example 66 demonstrates a form of coordination that the system does not do

Example 50 is the only that that I think the system should be able to
handle The problem is that for the perfect both the aux and the main
verb must be marked for subject.  The way that the rules are currently
set up the main verb is being marked for univ-present and the aux is
marked for continuous-present. I am going to change the rules so that
there is one lexeme-to-word rule which will only apply to something
that has the modified form or yesterday-past-tense.

Running the grammar again and actually doing interactive unification
instead of guessing at the problem.  It seems that the aux is not able
to take the cont.pres because it conflicts with the perfective.

Coverage 33%
Overgeneration 3.7 %
Errors 35

Realized that negation morpheme had not been added.  This will account
for some of the errors.

EB:

Changed inputs for verb-slot4 from this:

	verb-slot4_input1_type=iverb
	verb-slot4_input2_type=tverb
	
to this:

	verb-slot4_input1_type=verb
	verb-slot4_input2_type=verb-slot5

My thinking was that "any verb" (i.e. just verb) would be less
likely to have the extra supertype problem, and that verb-slot5 was
motiviated in parallelism to the remote past marker. This results
in a grammar that loads (yay!) and has the same coverage/overgeneration
as above.

   

  
---
hau
---

Problem:

Cycle involving TRANSITIVE-VERB-LEX

Repairs:

Changed the following:


  verb1_name=transitive -> verb1_name=trans
  verb2_name=intransitive -> verb2_name=intrans

New problem:

Error in 1PL-COMPLETIVE-WSP-TAM-AUX-LEX:
   No possible type for features (PNG E) at path (SYNSEM
                                                  LOCAL
                                                  CAT
                                                  VAL
                                                  COMPS
                                                  FIRST
                                                  LOCAL
                                                  CONT
                                                  HOOK
                                                  INDEX)
Error in 1S-COMPLETIVE-WSP-TAM-AUX-LEX:
   No possible type for features (PNG E) at path (SYNSEM
                                                  LOCAL
                                                  CAT
                                                  VAL
                                                  COMPS
                                                  FIRST
                                                  LOCAL
                                                  CONT
                                                  HOOK
                                                  INDEX)
Error in 2FS-COMPLETIVE-TAM-WSP-AUX-LEX:
   No possible type for features (PNG E) at path (SYNSEM
                                                  LOCAL
                                                  CAT
                                                  VAL
                                                  COMPS
                                                  FIRST
                                                  LOCAL
                                                  CONT
                                                  HOOK
                                                  INDEX)
Error in 2MS-COMPLETIVE-WSP-TAM-AUX-LEX:
   No possible type for features (E PNG) at path (SYNSEM
                                                  LOCAL
                                                  CAT
                                                  VAL
                                                  COMPS
                                                  FIRST
                                                  LOCAL
                                                  CONT
                                                  HOOK
                                                  INDEX)
Error in 2PL-COMPLETIVE-WSP-TAM-AUX-LEX:
   No possible type for features (PNG E) at path (SYNSEM
                                                  LOCAL
                                                  CAT
                                                  VAL
                                                  COMPS
                                                  FIRST
                                                  LOCAL
                                                  CONT
                                                  HOOK
                                                  INDEX)
Error in 3PL-COMPLETIVE-WSP-TAM-AUX-LEX:
   No possible type for features (PNG E) at path (SYNSEM
                                                  LOCAL
                                                  CAT
                                                  VAL
                                                  COMPS
                                                  FIRST
                                                  LOCAL
                                                  CONT
                                                  HOOK
                                                  INDEX)
Error in 4PL-COMPLETIVE-WSP-TAM-AUX-LEX:
   No possible type for features (E PNG) at path (SYNSEM
                                                  LOCAL
                                                  CAT
                                                  VAL
                                                  COMPS
                                                  FIRST
                                                  LOCAL
                                                  CONT
                                                  HOOK

Next: hack choices file to put that on the subject.

Hacked choices file to add auxN_featN_head=subj to all
of those, and now the grammar loads, but parses little:

coverage 1/38 2.6%
overgeneration 0
error 49

Added lexical entry for gidàa (house).

    noun1_stem11_orth=gidàa
    noun1_stem11_pred=_house_n_rel

coverage 1/38 2.6%
overgeneration 0
error 45

Added hyphen to suffix BFORM:

    verb-slot1_morph2_orth=-BFORM

.. no change

At least some examples we're losing because
of incorporated pronouns/object prodrop, e.g.:

# Example 30 Fourth person negative-completive. Negative-Completive is the negative counterpart for both the completive and preterite.  
Source: author
Vetted: f
Judgment: g
Phenomena: {tam, agreement, negation}
bà à san sù ba 
bà à san-BForm-su_ ba 
NEG 4pl know them NEG
 do not know them.

This one is not parsing, apparently because of the spelling
of the verb:

# Example 8 3ms completive verb with mandatory weak subject pronoun. 
Source: {a:569,c}
Vetted: s
Judgment: g
Phenomena: {tam, agreement}
Muusaa yaa koomà gidàa
Muusaa yaa koomà-CForm gidàa
Musa.3ms 3ms.COM return-CForm home
Musa returned home.

Changing verb to koomàa as it is in other examples.

Coverage: 2/38 5.3%
Overgeneration: 0
Error: 44

Added verb entry for zoo "come", though strictly speaking
I doubt this is a true transitive verb:

    verb2_stem6_orth=zoo
    verb2_stem6_pred=_come_v_rel

Added noun entry for nân "here" (arbitrarily as masculine),
though strictly speaking this probably isn't a common noun.

    noun1_stem12_orth=nân
    noun1_stem12_pred=_here_n_rel

Coverage: 3/38 7.9%
Overgeneration: 0
Error: 43

Negative examples won't parse because Hausa does two part
negation (not covered in negation library):

# Example 4 Negated habitual verb with mandatory weak subject pronoun. Modified from (a:565)
Source: author
Vetted: f
Judgment: g
Phenomena: {tam,negation}
hàdiizà bàa takàn zoo nân
hàdiizà bàa ta-kàn zoo-AForm nân ba
hàdiizà.fs NEG 3fs-HAB come-AForm here NEG
Hadiza does not come here.

Added lexical entry for "rat":

    noun2_stem4_orth=kuusùu
    noun2_stem4_pred=_rat_n_rel

LKB was token-breaking on ` (and turning ` into white space),
so I changed ` to \, in choices file and test suite. ... but
that gave itsdb problems (even though it worked interactively
through the LKB), so I changed \ to 7 everywhere.

Coverage: 4/38 10.5%
Overgeneration: 0
Error: 37

There seems to be two problems with this one:

yaaròo baa ya-à gyaarà-CForm kèekè
boy NEG he-cont repair-CForm bicycle
The boy is not repairing a bicycle.


First, baa elsewhere is bàa. Second, there is
no auxiliary ya.  Maybe it was supposed to be
'yaa'.  It looks to me like this example is testing
phonology we don't handle.  Would it make sense to
have the morpheme segmented line regularize further?

---
mal
---

Choices file doesn't validate, but doesn't leave any red stars.
Trying customize-one.py led to the system spinning.

Problem was disjunctive gender value on noun12: inanimate, non-rational.
Changed that to just inanimate, and got a grammar that loaded, but
with a cycle on non-rational, because noun10 still had that disjunctive
value.  Change that to just inanimate, and got on to next problem.

Cycle involving NOM-ACC-TRANSITIVE-VERB-LEX

Changed:

  verb1_name=nom-acc-transitive

to:

  verb1_name=nom-acc-trans

... and made similar changes for all the verb type names.

Grammar loads!

Coverage: 10/39 25.6%
Overgeneration: 2/37 5.4%
Errors: 29

Added stem for "read":

    verb1_stem2_orth=vaayi
    verb1_stem2_pred=_read_v_rel

Coverage: 10/39 25.6%
Overgeneration: 2/37 5.4%
Errors: 25

Changed spelling of one stem:

    noun1_stem3_orth=raamaan
    noun1_stem3_pred=_name_n_rel

    noun1_stem3_orth=raaman
    noun1_stem3_pred=_name_n_rel

Coverage: 10/39 25.6%
Overgeneration: 2/37 5.4%
Errors: 23

#56 not parsing because coordination is
not fully retrofitted to new morphotactics. In particular,
infl-bottom-coord-rule requires that the daughter be
[INFLECTED -], but the daughter in this case has
gone through a lexeme-to-word-rule.  

Added stem for "fall":

    verb2_stem2_orth=viiZ
    verb2_stem2_pred=_fall_v_rel

#58, 59 don't parse because affix-marked coordination
is not supported for phrases (NP, VP, S)

Something very puzzling here:

TSNLP(3): (lkb::do-parse-tty "atE cirikk-tu")
Error: 
Rule PAST_VERB returned from morph analyser is undefined (error in grammar
       loading?)

There is nothing called "past_verb" anywhere in the
.tdl, so I have now idea how the morph analyzer is getting
that. Even tried restarting the LKB to make sure it
wasn't left over from some other grammar.

Found the culprit: We'd left in an irregs.tab file initalized
with an example from English:

"
ate PAST_VERB eat
"

Not sure if it's legit to remove this or not.

Coverage: 10/39 25.6%
Overgeneration: 2/37 5.4%
Errors: 22

Problem with this example:

kuTTi amma-e viLi-ccu
child.nom mother-acc call-past
The child called the mother.


appears to be that the past tense rule is ltol, i.e.,
viLi-ccu is [INFLECTED -].

Fixed that by making verb-slot4 and verb-slot5 (negation
markers) optional.

  verb-slot4_opt=on
  verb-slot5_opt=on

Coverage 29/39 74.4%
Overgeneration 2/37 5.4%
Errors: 24

That seems to have introduced a new error for this example (#65):

kuTTi cirikk-uka-aaNe-irunnu
child.nom laugh-infinitive-imperfect-past
'The child was laughing.'

Item 14 wasn't parsing and furthermore was getting subj-head
and comp-head attachment for subject of intransitive verb.
Changed this:

  verb4_valence=trans

to this:

  verb4_valence=intrans

Coverage 30/39 76.9%
Overgeneration 2/37 5.4%
Errors: 24

Two ungrammatical examples parsing:

#Ex 36 demonstrates an ungrammatical use of tense.  Here the verb appears without the tense marker.
Source: author
Vetted: f
Judgment: u
Phenomena: {tam}
kuTTi cirikk
kuTTi cirikk
child.nom laugh
'The child laughs.'

--> The problem here is a bug in the morphotactics that
lead to tense-aspect-rule-dtr being a supertype of verb-lex,
despite nothing in the choices file indicating that.

#Ex 71 demonstrates ungrammatical present habitual.  It is formed by adding "-aaRE" and "-uNTE" to the verb stem.  Here they are attached to the present tense stem.
Source: author
Vetted: f
Judgment: u
Phenomena: {tam}
kuTTi cirikkunnaaRuNTaayirunnu
kuTTi cirikk-unnu-aaRE-uNTE
child.nom laugh-pres-hab-hab.pres
'The child was laughing.'

--> This one we might be able to fix, since there
seem to be two ways of doing -aaRe-uNTe, all at once
or in two pieces.

SS--I loaded the grammar and received an error for the imperfective-marker-rule.  The error stated there was a strange character.  I checked irules.tdl and noticed an
extra space.  I removed the space and reloaded the grammar without errors.

Trying to fix the problems with Ex 71, 66, 69, 70, I removed the second morpheme -aaRE-uNTe from the faked-tense-aspect-marker slot and created a new slot for it that takes any verb as an input.  The new grammar has slightly improved coverage.

Coverage 79.5%
Overgeneration 2.7%

Ex 71 was eliminated
Ex 66 parsed

I think that the problem with #69 and #70 is that I did not update the tense-aspect 
slot to have the new slot as input.

Coverage 84.6%
Overgeneration 2.7%

I think that this is the most that we will be able to do.


---
kal:
---

Original choices file didn't load:

Cycle involving TRANSITIVE-VERB-LEX

Changed   
	  verb1_name=transitive
	  verb2_name=intransitive

to

	  verb1_name=trans
	  verb2_name=intrans

New error:

3S-3P-SUBJ-OBJ-MARKER-LEX-RULE

3s-3p-subj-obj-marker-lex-rule := transitive-subj-obj-markers-lex-rule &
  [ SYNSEM.LOCAL.CAT.VAL.SUBJ.FIRST.LOCAL.CONT.HOOK.INDEX.PNG [ NUM singular & plural,
                                                                PER 3rd ] ].

We shouldn't be outputting such tdl :)  (Though this is a choices
file that doesn't pass validation; possibly this is why.)

Changed subj to obj on these:

      verb-slot4_morph9_feat3_name=number
      verb-slot4_morph9_feat3_value=plural
      verb-slot4_morph9_feat3_head=obj
      verb-slot4_morph9_feat4_name=person
      verb-slot4_morph9_feat4_value=3rd
      verb-slot4_morph9_feat4_head=obj

New error:

Feature MOOD is introduced at multiple types (TAM PNG)

It looks like mood is basically just a reflection
of SF, so I removed the feature and replaced all 
references to it (other than those that end up with
just [MOOD mood]) with [QUESTION plus] and [QUESTION minus]
respectively.  In some cases, the QUESTION feature was
already being used.  This probably isn't going to get
the facts right for indicative markers (e.g., the
indicative negative marker), since I don't think we're
doing anything with [QUESTION minus].

Coverage 2/34 5.9%
Overgeneration 0
Error 59

Added input for verb-slot5:

    verb-slot5_input1_type=verb-slot8

... but that was circular until I removed this:

    verb-slot8_input2_type=verb-slot5

Coverage 8/34 23.5%
Overgeneration 2/34 4.5%
Error 41

Six items in the test suite had -vaa instead of -va-a,
glossed as indic.3sg(subj).3sg(obj).  Regularized
this to -va-a.

Coverage 14/34 41.2%
Overgeneration 2/34 4.5%
Error 35

Changed spelling of this affix from -pput:

    verb-slot1_morph9_orth=-ppu


Changed input from verb-slot10:

    verb-slot1_input1_type=verb2

Undid last change.  Changed spelling of -pput/-ppu to -ppu-t

Coverage 14/34 41.2%
Overgeneration 2/34 4.5%
Error 32

Changed spelling of affix in item 11 from -vuq to -vu-q

Coverage 14/34 41.2%
Overgeneration 2/34 4.5%
Error 31

All errors on items except 36, 47, 60, 63, and 66
concern ungrammatical items.  
Possibly expected errors, though this should be checked.

#Ex 36 demonstrates a yes-no question.  They are formed by using the interrogative mood inflection.  Some of the interrogative mood inflections are the same as the indicative inflections.
Source: author
Vetted: f
Judgment: g
Phenomena: q
illit niririirpit
illit niri-riir-vi-t
you.sing eat-already-inter-2s
'Have you already eaten?'

If -riir is a tense/aspect marker, we should add
a rule for it.  If it's an incorporated adverb,
then I guess this one's hopeless.

Added 3pl(subj) 3s(obj) marker:

    verb-slot4_morph11_name=3p-3s-subj-obj-marker
    verb-slot4_morph11_orth=-at
      verb-slot4_morph11_feat1_name=number
      verb-slot4_morph11_feat1_value=singular
      verb-slot4_morph11_feat1_head=obj
      verb-slot4_morph11_feat2_name=person
      verb-slot4_morph11_feat2_value=3rd
      verb-slot4_morph11_feat2_head=subj
      verb-slot4_morph11_feat3_name=number
      verb-slot4_morph11_feat3_value=singular
      verb-slot4_morph11_feat3_head=subj
      verb-slot4_morph11_feat4_name=person
      verb-slot4_morph11_feat4_value=3rd
      verb-slot4_morph11_feat4_head=obj

But this one is still hopeless, because of non-retrofitted
coordination:

#Ex 47 demonstrates NP coordination. "Two NPs may be coordinated by enclitics "-lu" or "lunnitt" on the first constiuent of the last or on each NP in a stronger "both-and" or "either-or" sense" (a:126).
Source: author
Vetted: f
Judgment: g
Phenomena: {word order, case}
tuluit qallunaat kalaallillu puisi pisaraat
tulu-t qallunaa-t kalaalli-t-lu puisi pisar-va-at
englishman-pl dane-pl greenlander-pl-and seal.abs catch-indic-3pl(subj).3s(obj)
'Englishmen, Danes and Greenlanders caught the seal.'

The note here doesn't make sense to me:

#Ex 60 demonstrates an ungrammatical example where the subject marker on the verb does not agree with the subject.
Source: author
Vetted: f
Judgment: g
Phenomena: agr
uku nirivupput
uku niri-vu-ppu-t
3pl eat-indic-indic-3pl
'They ate.'

Maybe this was supposed to be ungrammatical for some other
reason?

#Ex 62 demonstrates subject-object-verb agreement.  
Source: author
Vetted: f
Judgment: g
Phenomena: agr
uangap ilissi pisarvassi
uanga-p ilissi pisar-va-ssi
I-rel 2pl catch-indic.1s(subj).2pl(obj)
'I caught you.'

Corrected spelling of 2pl pronoun from illissi to ilissi
(to be consistent with choices file and the rest of the
test suite).

... that's still not parsing, apparently because there is
no appropriate case rule for the plural pronoun.  The zero
marked form says that it is singular.  

#Ex 66 demonstrates subject-object-verb agreement.  
Source: author
Vetted: f
Judgment: g
Phenomena: agr
illit puisit pisarvasi
illi-p puisi-t pisar-va-si
2s-rel seal.pl catch-indic.2pl(subj).3pl(obj)
'You caught seals.

This one has a singular subject and plural agreement
marking, so the grammar is apparently correctly ruling it
out.  Replace with correct grammatical example? Also add
correct grammatical example?  Also, the 2s pronoun should
be illit, not illi.

More error analysis:

#Ex 7  demonstrates that an intransitive verb takes a subject in the absolutive case.  (I am not confident that the top line shows the proper spelling according to source b, if a verb base ends in a consonant "p" is used instead of "v".) Vocabulary for "qimmiq/dog" and "qilut/bark" taken from a:280
Source: author
Vetted: f
Judgment: g
Phenomena: {word order, case, agr}
qimmiq qilutpuq
qimmiq qilut-vu-q
dog.abs bark-indic-3s
'The dog barked.'

The grammar thinks that qilut-vu-q is not fully inflected.  Apparently
the same problem with 10.

---
abk:
---

Initial choices file customizes but creates a grammar that
doesn't load:

Unifications specified are invalid or do not unify
Type 3SING-LEX-RULE has an invalid constraint specification
Invalid type AORIST
Unifications specified are invalid or do not unify
Type AORIST-MARKER-LEX-RULE has an invalid constraint specification
Invalid type AORIST
Unifications specified are invalid or do not unify
Type AORIST-NEGATIVE-MARKER-LEX-RULE has an invalid constraint specification
Error: Problems in type file

The problem with 3SING-LEX-RULE was several morphs with the name value
"3sing", which despite belonging to different slots, ended up getting
defined as the same type.

    verb-slot1_morph1_name=3sing
    verb-slot2_morph1_name=3sing
    verb-slot3_morph1_name=3sing
    verb-slot4_morph1_name=3sing
    verb-slot11_morph1_name=3sing

The problem with aorist was (apparently) that it had
no supertype declared, which led to the system not defining
it in the tdl at all:

section=tense-aspect
tense-definition=build
  tense1_name=present
    tense1_supertype1_name=tense
  tense2_name=aorist
  tense3_name=past
    tense3_supertype1_name=tense
  aspect1_name=indefinite
    aspect1_supertype1_name=aspect
  aspect2_name=habitual
    aspect2_supertype1_name=aspect

Added:

    tense2_supertype1_name=tense

Now the grmmar loads, but I get these warnings:

WARNING: Rule `1SING-NON-ERG-SUBJ-MARKER-PREFIX' redefined.
WARNING: Rule `1PL-NON-ERG-SUBJ-MARKER-PREFIX' redefined.
WARNING: Rule `2SING-MASC-NON-ERG-SUBJ-MARKER-PREFIX' redefined.
WARNING: Rule `2PL-NON-ERG-SUBJ-MARKER-PREFIX' redefined.
WARNING: Rule `2FEM-NON-ERG-SUBJ-MARKER-PREFIX' redefined.
WARNING: Rule `3SING-FEM-NON-ERG-SUBJ-MARKER-PREFIX' redefined.
WARNING: Rule `3PL-NON-ERG-SUBJ-MARKER-PREFIX' redefined.

These warnings are because the irules.tdl file contains duplicate
entries for each of the above rules.  The entries are exact
duplicates, so there is no harm done wrt to parsing, but it is
definitely a bug somewhere.

Initial results:

Coverage 25/35 71.4%
Overgeneration 6/54 11.1%
Error 43

Error analysis:

#Ex 7 demonstrates the indefinite article.  It is a suffix '-k'
Source: author
Vetted: f
Judgment: g
Phenomena: det
t͡ʂʰkʷʰən-k atəpha dəjəbajt
t͡ʂʰkʷʰən-k a-təpha də-jə-ba-jt
boy-a the-girl her-he-see-dynamic.finite
A boy saw the girl.

Not parsing, because the indefinite suffix isn't defined.
But the definite prefix is.  So maybe we can do an indefinite
suffix, even if we can't get the meaning quite right.

#Ex 15 demonstrates the  habitual aspect. It is formed by adding the suffix "-la" after the verb and before the tense marker
Source: author
Vetted: f
Judgment: g
Phenomena: tam
at͡ʂʰkʷʰən atəpha dəjəbajt
a-t͡ʂʰkʷʰən a-təpha də-jə-ba-la-wa-jt
the-boy the-girl her-he-see-habitual-present-dynamic.finite
The boy sees the girl regularly.

While chasing down this one, I noticed that this rule doesn't
have any featural content:  

  verb-slot6_order=after
    verb-slot6_input1_type=verb2
    verb-slot6_input2_type=verb3
    verb-slot6_morph1_name=habitual-aspect-marker
    verb-slot6_morph1_orth=-la

It should probably constrain the aspect, at least!

The problem with #15 seems to be that the aspect marker won't
take the obj marker as an input, and the subj marker won't take
the aspect marker as an input.  Try this:

  verb-slot6_name=aspect-marker
  verb-slot6_opt=on
  verb-slot6_order=after
    verb-slot6_input1_type=verb-slot1
    verb-slot6_input2_type=verb-slot2
    verb-slot6_input3_type=verb-slot3
    verb-slot6_input4_type=verb-slot4
    verb-slot6_morph1_name=habitual-aspect-marker
    verb-slot6_morph1_orth=-la

Output now parses twice.

Trying with aspect information:

  verb-slot6_name=aspect-marker
  verb-slot6_opt=on
  verb-slot6_order=after
    verb-slot6_input1_type=verb-slot1
    verb-slot6_input2_type=verb-slot2
    verb-slot6_input3_type=verb-slot3
    verb-slot6_input4_type=verb-slot4
    verb-slot6_morph1_name=habitual-aspect-marker
    verb-slot6_morph1_orth=-la
    verb-slot6_morph1_feat1_name=aspect
    verb-slot6_morph1_feat1_value=habitual

That rescued ex #15, but also doubled the ambiguity just
about everywhere, so I think it's probably not quite right!

Backed out the change to check that that really happened (since
the 32 examples with increased ambiguity can't all involve
verb-slot6) and sure enough, it did.  I think there might be something
buggy here in the slot code, but maybe the problem was that
verb-slot6 was optional twice (with the opt check box and because
the other things could hop over it and get to 1,2,3,4).  That
combined with saying 1,2,3,4 instead of just 1,4 like verb-slot
5 might have done it.  Trying this now:

  verb-slot6_name=aspect-marker
  verb-slot6_order=after
    verb-slot6_input1_type=verb-slot1
    verb-slot6_input2_type=verb-slot2
    verb-slot6_input3_type=verb-slot3
    verb-slot6_input4_type=verb-slot4
    verb-slot6_morph1_name=habitual-aspect-marker
    verb-slot6_morph1_orth=-la
    verb-slot6_morph1_feat1_name=aspect
    verb-slot6_morph1_feat1_value=habitual

That gained one (#15) but lost two (#24, #35).

Next try:

  verb-slot6_name=aspect-marker
  verb-slot6_opt=on
  verb-slot6_order=after
    verb-slot6_input1_type=verb-slot1
    verb-slot6_input2_type=verb-slot4
    verb-slot6_morph1_name=habitual-aspect-marker
    verb-slot6_morph1_orth=-la
    verb-slot6_morph1_feat1_name=aspect
    verb-slot6_morph1_feat1_value=habitual

That worked (once I fixed a typo from input4 to input2).

Coverage: 26/35 74.3%
Overgeneration: 6/54 11.1%
Error: 42

Corrected ? to another character in these two examples:

#Ex 42 demonstrates verb subject agreement.  
Source: author
Vetted: f
Judgment: g
Phenomena: agr
bará atəpha dəbəbajt
bará a-təpha də-b-ba-jt
you.fem the-girl her-you.fem-see-dynamic.finite
You saw the girl.


#Ex 67 demonstrates verb object agreement
Source: author
Vetted: f
Judgment: g
Phenomena: agr
atəphat?sa at͡ʂʰkʷʰən j?j?bajt
a-təpha-t͡ʂʰa a-t͡ʂʰkʷʰən j-jə-ba-jt
the-girl -pl the-boy 3rd.pl-he-see-dynamic.finite
The boy saw the girls.

That fixed 42, but not 67 (aka 69).

Changed #68 (aka 70) similarly:

#Ex 68 demonstrates verb object agreement. 
Source: author
Vetted: f
Judgment: g
Phenomena: agr
a-mat-k?a at͡ʂʰkʷʰən  jəjəbajt
a-mat-kʷʰa  a-t͡ʂʰkʷʰən j-jə-ba-jt
snake-pl  the-boy 3rd.pl-he-see-dynamic.finite
The boy saw the snakes.

Changed +p to -p in choices file and item (affects 84 & 85).

Coverage: 27/35 77.1%
Overgeneration: 6/54 11.1%
Error: 40

#Ex 65 demonstrates verb object agreement. 
Source: author
Vetted: f
Judgment: g
Phenomena: agr
at͡ʂʰkʷʰən a-ab dəjəbajt
a-t͡ʂʰkʷʰən a-ab də-jə-ba-jt
the-boy the-father 3rd.human.sing-he-see-dynamic.finite
The boy saw the father.

Not parsing because of a-ab.  Added stem for "father":

    noun1_stem2_orth=ab
    noun1_stem2_pred=_father_n_rel

Coverage: 29/35 82.9%
Overgeneration: 6/54 11.1%
Error: 36

*** This one is giving an error:

#Ex 66 demonstrates verb object agreement. The normal order of subject and object are inverted to avoid the 3rd non-human sing/3rd plural marker from occurring directly after the object.  When that happens the object marker is dropped.
Source: author
Vetted: f
Judgment: g
Phenomena: agr
a-mat at͡ʂʰkʷʰən j?j?bajt
a-mat a-t͡ʂʰkʷʰən  j-jə-ba-jt
the- snake the-boy it-he-see-dynamic.finite
The boy saw the snake.

... but I don't understand how the comment relates to the
example, so I'm leaving this one for Safiyyah.

*** This one seems related:

#Ex 67 demonstrates verb object agreement
Source: author
Vetted: f
Judgment: g
Phenomena: agr
atəphat?sa at͡ʂʰkʷʰən j?j?bajt
a-təpha-t͡ʂʰa a-t͡ʂʰkʷʰən j-jə-ba-jt
the-girl -pl the-boy 3rd.pl-he-see-dynamic.finite
The boy saw the girls.

I think that we probably need separate slots for these markers,
but that's a job for Safiyyah :)

Same thing here:

#Ex 68 demonstrates verb object agreement. 
Source: author
Vetted: f
Judgment: g
Phenomena: agr
a-mat-k?a at͡ʂʰkʷʰən  jəjəbajt
a-mat-kʷʰa  a-t͡ʂʰkʷʰən j-jə-ba-jt
snake-pl  the-boy 3rd.pl-he-see-dynamic.finite
The boy saw the snakes.

Added indefinite marker (for #7):

  noun-slot3_name=indef
  noun-slot3_order=after
    noun-slot3_input1_type=noun1
    noun-slot3_input2_type=noun2
    noun-slot3_input3_type=noun3
    noun-slot3_morph1_name=indef-marker
    noun-slot3_morph1_orth=-k
    noun-slot3_constraint1_type=Cannot co-occur
    noun-slot3_constraint1_other-slot=noun-slot1

Coverage: 30/35 85.7%
Overgenerarion: 6/54 11.1%
Error: 35


#Ex 34 demonstrates ungrammatical negation of the aorist tense.  It is formed by placing "m-" before the verb stem and keeping the dynamic/finite marker.  Here the neg marker comes before the subject marker.
Source: author
Vetted: f
Judgment: u
Phenomena: neg
at͡ʂʰkʷʰən atəpha dəjəbawajt
a-t͡ʂʰkʷʰən a-təpha də-m-jə-ba-jt
the-boy the-girl her-neg-he-see-jt
The boy did not see the girl.

The problem here is that the verb form is coming up as
[INFLECTED -].  I suspect this might have something to
do with the unusual order of affixes noted in the comment.

#Ex 82 demonstrates an intransitive stative verb.  Stative verbs only have past, present, and future as finite tenses.
Source: author
Vetted: f
Judgment: g
Phenomena: tam
atəpha dət͡ɕʷʰaw-p
a-təpha də-t͡ɕʷʰa-w-p
the-girl 3.human.sing-sleep-present.stative
The girl is sleeping.

The problem here seems to be that the lexical rule for the
prefix won't take a stative verb as an input.  I'm not sure
I'm looking at the right lex rule, though, so passing this
one over to Safiyyah.

Looking at overgeneration cases now:

#Ex 23 demonstrates an ungrammatical use of the aorist tense.  The aorist tense has a zero marker that comes before the dynamic/finite marker.  Here the dynamic/finite marker is missing.
Source: author
Vetted: f
Judgment: u
Phenomena: word order
at͡ʂʰkʷʰən atəpha dəjəbajt
a-t͡ʂʰkʷʰən a-təpha də-jə-ba
the-boy the-girl her-he-see
The boy saw the girl.

This will require some debugging of the lex rule dependencies,
I think. (#24 in [incr tsdb()]).

This one (#35 to [incr tsdb()]) seems to be related:

#Ex 33 demonstrates ungrammatical negation of the aorist tense.  It is formed by placing "m-" before the verb stem and keeping the dynamic/finite marker.  Here the dynamic/finite marker is missing
Source: author
Vetted: f
Judgment: u
Phenomena: neg
at͡ʂʰkʷʰən atəpha dəjəbawajt
a-t͡ʂʰkʷʰən a-təpha də-jə-m-ba
the-boy the-girl her-he-neg-see
The boy did not see the girl.

This one was because the morph was underconstrained:

#Ex 50 demonstrates ungrammatical  verb subject agreement.  Third person masculine singular subject takes a second person plural agreement marker.
Source: author
Vetted: f
Judgment: u
Phenomena: agr
jará atəpha dəʃʷəbajt
jará a-təpha də-ʃʷə-ba-jt
he the-girl her-you.pl-see-dynamic.finite
He saw the girl.

added this:

      verb-slot1_morph5_feat1_name=pernum
      verb-slot1_morph5_feat1_value=2plural
      verb-slot1_morph5_feat1_head=subj

      verb-slot3_morph5_feat1_name=pernum
      verb-slot3_morph5_feat1_value=2plural
      verb-slot3_morph5_feat1_head=obj

      verb-slot4_morph5_feat1_name=pernum
      verb-slot4_morph5_feat1_value=2plural
      verb-slot4_morph5_feat1_head=subj

Now 50 (aka 52) no longer parses.  (only one of those was relevant
in this case, but they all needed it ;)

Coverage: 30/35 85.7%
Overgenerarion: 5/54 9.3%
Error: 35
